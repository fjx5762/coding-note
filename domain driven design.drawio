<mxfile host="app.diagrams.net" modified="2022-07-03T08:08:57.658Z" agent="5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.0.0 Safari/537.36" etag="muRqPrf01Vbrt1oSl2s_" version="20.0.4" type="github" pages="2">
  <diagram id="o0IBLR_WmbubAZ78KdnO" name="Domain Primitive">
    <mxGraphModel dx="946" dy="614" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <UserObject label="参考文章" link="https://zhuanlan.zhihu.com/p/340911587" id="xhAw2geh87z7_WKdA8rC-1">
          <mxCell style="fontColor=#0000EE;fontStyle=4;rounded=1;overflow=hidden;spacing=10;sketch=1;" vertex="1" parent="1">
            <mxGeometry x="130" y="90" width="150" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="xhAw2geh87z7_WKdA8rC-2" value="&lt;span style=&quot;color: rgb(33, 37, 41); font-size: 14px; background-color: rgb(255, 255, 255);&quot;&gt;DP是一个完整的概念整体，具备精准的定义&lt;br&gt;DP是一个传统意义上的ValueObject 无状态且不可变的&lt;br&gt;DP可以是业务最小组成部分，DP之间可以是组合关系&lt;br&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fontFamily=Helvetica;fontSize=14;align=left;" vertex="1" parent="1">
          <mxGeometry x="330" y="60" width="380" height="120" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-4" value="三个原则" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fontFamily=Helvetica;fontSize=14;align=left;" vertex="1" parent="1">
          <mxGeometry x="130" y="715" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-6" value="四个维度" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fontFamily=Helvetica;fontSize=14;align=left;" vertex="1" parent="1">
          <mxGeometry x="130" y="410" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-40" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;sketch=1;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=14;" edge="1" parent="1" source="xhAw2geh87z7_WKdA8rC-9" target="xhAw2geh87z7_WKdA8rC-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-41" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;sketch=1;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=14;" edge="1" parent="1" source="xhAw2geh87z7_WKdA8rC-9" target="xhAw2geh87z7_WKdA8rC-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-43" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;sketch=1;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=14;" edge="1" parent="1" source="xhAw2geh87z7_WKdA8rC-9" target="xhAw2geh87z7_WKdA8rC-42">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-9" value="&lt;meta charset=&quot;utf-8&quot;&gt;&lt;span style=&quot;color: rgb(33, 37, 41); font-family: system-ui, -apple-system, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Helvetica Neue&amp;quot;, Arial, &amp;quot;Noto Sans&amp;quot;, &amp;quot;Liberation Sans&amp;quot;, sans-serif, &amp;quot;Apple Color Emoji&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;Segoe UI Symbol&amp;quot;, &amp;quot;Noto Color Emoji&amp;quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline !important;&quot;&gt;接口的清晰度&lt;/span&gt;" style="whiteSpace=wrap;html=1;fontSize=14;align=left;rounded=1;sketch=1;" vertex="1" parent="1">
          <mxGeometry x="300" y="320" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-45" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;sketch=1;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=14;" edge="1" parent="1" source="xhAw2geh87z7_WKdA8rC-13" target="xhAw2geh87z7_WKdA8rC-44">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-13" value="&lt;span style=&quot;color: rgb(33, 37, 41); font-family: system-ui, -apple-system, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Helvetica Neue&amp;quot;, Arial, &amp;quot;Noto Sans&amp;quot;, &amp;quot;Liberation Sans&amp;quot;, sans-serif, &amp;quot;Apple Color Emoji&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;Segoe UI Symbol&amp;quot;, &amp;quot;Noto Color Emoji&amp;quot;; font-size: 16px; background-color: rgb(255, 255, 255);&quot;&gt;数据验证和错误处理&lt;/span&gt;" style="whiteSpace=wrap;html=1;fontSize=14;align=left;rounded=1;sketch=1;" vertex="1" parent="1">
          <mxGeometry x="300" y="380" width="170" height="60" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-47" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;sketch=1;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=14;" edge="1" parent="1" source="xhAw2geh87z7_WKdA8rC-15" target="xhAw2geh87z7_WKdA8rC-46">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-15" value="&lt;span style=&quot;color: rgb(33, 37, 41); font-family: system-ui, -apple-system, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Helvetica Neue&amp;quot;, Arial, &amp;quot;Noto Sans&amp;quot;, &amp;quot;Liberation Sans&amp;quot;, sans-serif, &amp;quot;Apple Color Emoji&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;Segoe UI Symbol&amp;quot;, &amp;quot;Noto Color Emoji&amp;quot;; font-size: 16px; background-color: rgb(255, 255, 255);&quot;&gt;业务逻辑代码的清晰度&lt;/span&gt;" style="whiteSpace=wrap;html=1;fontSize=14;align=left;rounded=1;sketch=1;" vertex="1" parent="1">
          <mxGeometry x="300" y="440" width="170" height="60" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-49" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;sketch=1;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=14;" edge="1" parent="1" source="xhAw2geh87z7_WKdA8rC-16" target="xhAw2geh87z7_WKdA8rC-48">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-16" value="&lt;font face=&quot;system-ui, -apple-system, Segoe UI, Roboto, Helvetica Neue, Arial, Noto Sans, Liberation Sans, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji&quot; color=&quot;#212529&quot;&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;可测试性&lt;/span&gt;&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=14;align=left;rounded=1;sketch=1;" vertex="1" parent="1">
          <mxGeometry x="300" y="500" width="170" height="60" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-18" value="&lt;span style=&quot;box-sizing: border-box; font-weight: bolder; color: rgb(33, 37, 41); font-family: system-ui, -apple-system, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Helvetica Neue&amp;quot;, Arial, &amp;quot;Noto Sans&amp;quot;, &amp;quot;Liberation Sans&amp;quot;, sans-serif, &amp;quot;Apple Color Emoji&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;Segoe UI Symbol&amp;quot;, &amp;quot;Noto Color Emoji&amp;quot;; font-size: 16px; background-color: rgb(255, 255, 255);&quot;&gt;将隐性的概念显性化&lt;/span&gt;" style="whiteSpace=wrap;html=1;fontSize=14;align=left;rounded=1;sketch=1;" vertex="1" parent="1">
          <mxGeometry x="300" y="650" width="180" height="60" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-23" value="&lt;pre style=&quot;box-sizing: border-box; font-family: var(--bs-font-monospace); font-size: 0.875em; direction: ltr; unicode-bidi: bidi-override; display: block; margin-bottom: 1.25rem; overflow: auto; background: rgb(233, 236, 239); padding: 1rem; max-height: 35rem; line-height: 1.5; position: relative; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; margin-top: 0px !important;&quot; class=&quot;hljs language-typescript&quot;&gt;&lt;font color=&quot;#d73a49&quot;&gt;通过手机号码获取区号与手机号码的校验 封装为DP&lt;/font&gt;&lt;/pre&gt;&lt;pre style=&quot;box-sizing: border-box; font-family: var(--bs-font-monospace); font-size: 0.875em; direction: ltr; unicode-bidi: bidi-override; display: block; margin-top: 0px !important; margin-bottom: 1.25rem; overflow: auto; color: rgb(36, 41, 46); background: rgb(233, 236, 239); padding: 1rem; max-height: 35rem; line-height: 1.5; position: relative; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot; class=&quot;hljs language-typescript&quot;&gt;&lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title class_&quot;&gt;PhoneNumber&lt;/span&gt; {&lt;br&gt;&lt;br&gt;    &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; final &lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(227, 98, 9);&quot; class=&quot;hljs-built_in&quot;&gt;number&lt;/span&gt;;&lt;br&gt;    &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title function_&quot;&gt;getNumber&lt;/span&gt;(&lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {&lt;br&gt;        &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(227, 98, 9);&quot; class=&quot;hljs-built_in&quot;&gt;number&lt;/span&gt;;&lt;br&gt;    }&lt;br&gt;&lt;br&gt;    &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title class_&quot;&gt;PhoneNumber&lt;/span&gt;(&lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(227, 98, 9);&quot; class=&quot;hljs-built_in&quot;&gt;number&lt;/span&gt;) {&lt;br&gt;        &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span style=&quot;box-sizing: border-box; color: rgb(227, 98, 9);&quot; class=&quot;hljs-built_in&quot;&gt;number&lt;/span&gt; == &lt;span style=&quot;box-sizing: border-box; color: rgb(0, 92, 197);&quot; class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) {&lt;br&gt;            &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title class_&quot;&gt;ValidationException&lt;/span&gt;(&lt;span style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot; class=&quot;hljs-string&quot;&gt;&quot;number不能为空&quot;&lt;/span&gt;);&lt;br&gt;        } &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title function_&quot;&gt;isValid&lt;/span&gt;(&lt;span style=&quot;box-sizing: border-box; color: rgb(227, 98, 9);&quot; class=&quot;hljs-built_in&quot;&gt;number&lt;/span&gt;)) {&lt;br&gt;            &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title class_&quot;&gt;ValidationException&lt;/span&gt;(&lt;span style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot; class=&quot;hljs-string&quot;&gt;&quot;number格式错误&quot;&lt;/span&gt;);&lt;br&gt;        }&lt;br&gt;        &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-property&quot;&gt;number&lt;/span&gt; = &lt;span style=&quot;box-sizing: border-box; color: rgb(227, 98, 9);&quot; class=&quot;hljs-built_in&quot;&gt;number&lt;/span&gt;;&lt;br&gt;    }&lt;br&gt;&lt;br&gt;    &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title function_&quot;&gt;getAreaCode&lt;/span&gt;(&lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {&lt;br&gt;        &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (int i = &lt;span style=&quot;box-sizing: border-box; color: rgb(0, 92, 197);&quot; class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span style=&quot;box-sizing: border-box; color: rgb(227, 98, 9);&quot; class=&quot;hljs-built_in&quot;&gt;number&lt;/span&gt;.&lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title function_&quot;&gt;length&lt;/span&gt;(); i++) {&lt;br&gt;            &lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; prefix = &lt;span style=&quot;box-sizing: border-box; color: rgb(227, 98, 9);&quot; class=&quot;hljs-built_in&quot;&gt;number&lt;/span&gt;.&lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title function_&quot;&gt;substring&lt;/span&gt;(&lt;span style=&quot;box-sizing: border-box; color: rgb(0, 92, 197);&quot; class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, i);&lt;br&gt;            &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title function_&quot;&gt;isAreaCode&lt;/span&gt;(prefix)) {&lt;br&gt;                &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; prefix;&lt;br&gt;            }&lt;br&gt;        }&lt;br&gt;        &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(0, 92, 197);&quot; class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;&lt;br&gt;    }&lt;br&gt;&lt;br&gt;    &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(227, 98, 9);&quot; class=&quot;hljs-built_in&quot;&gt;boolean&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title function_&quot;&gt;isAreaCode&lt;/span&gt;(&lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-params&quot;&gt;&lt;span style=&quot;box-sizing: border-box; color: rgb(227, 98, 9);&quot; class=&quot;hljs-built_in&quot;&gt;String&lt;/span&gt; prefix&lt;/span&gt;) {&lt;br&gt;        &lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt;[] areas = &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt;[]{&lt;span style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot; class=&quot;hljs-string&quot;&gt;&quot;0571&quot;&lt;/span&gt;, &lt;span style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot; class=&quot;hljs-string&quot;&gt;&quot;021&quot;&lt;/span&gt;, &lt;span style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot; class=&quot;hljs-string&quot;&gt;&quot;010&quot;&lt;/span&gt;};&lt;br&gt;        &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title class_&quot;&gt;Arrays&lt;/span&gt;.&lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title function_&quot;&gt;asList&lt;/span&gt;(areas).&lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title function_&quot;&gt;contains&lt;/span&gt;(prefix);&lt;br&gt;    }&lt;br&gt;&lt;br&gt;    &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(227, 98, 9);&quot; class=&quot;hljs-built_in&quot;&gt;boolean&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title function_&quot;&gt;isValid&lt;/span&gt;(&lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-params&quot;&gt;&lt;span style=&quot;box-sizing: border-box; color: rgb(227, 98, 9);&quot; class=&quot;hljs-built_in&quot;&gt;String&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(227, 98, 9);&quot; class=&quot;hljs-built_in&quot;&gt;number&lt;/span&gt;&lt;/span&gt;) {&lt;br&gt;        &lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; pattern = &lt;span style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot; class=&quot;hljs-string&quot;&gt;&quot;^0?[1-9]{2,3}-?\\d{8}$&quot;&lt;/span&gt;;&lt;br&gt;        &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(227, 98, 9);&quot; class=&quot;hljs-built_in&quot;&gt;number&lt;/span&gt;.&lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title function_&quot;&gt;matches&lt;/span&gt;(pattern);&lt;br&gt;    }&lt;br&gt;&lt;br&gt;}&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;fontSize=14;fontFamily=Helvetica;" vertex="1" parent="1">
          <mxGeometry x="841" y="100" width="400" height="600" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-24" value="&lt;meta charset=&quot;utf-8&quot;&gt;&lt;pre style=&quot;box-sizing: border-box; font-family: var(--bs-font-monospace); font-size: 0.875em; direction: ltr; unicode-bidi: bidi-override; display: block; margin-top: 0px !important; margin-bottom: 1.25rem; overflow: auto; color: rgb(36, 41, 46); background: rgb(233, 236, 239); padding: 1rem; max-height: 35rem; line-height: 1.5; position: relative; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot; class=&quot;hljs language-pgsql&quot;&gt;&lt;span style=&quot;box-sizing: border-box; color: rgb(227, 98, 9);&quot; class=&quot;hljs-built_in&quot;&gt;public&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;User&lt;/span&gt; {&#xa;    UserId userId;&#xa;    &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-type&quot;&gt;Name&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-type&quot;&gt;name&lt;/span&gt;;&#xa;    PhoneNumber phone;&#xa;    Address address;&#xa;    RepId repId;&#xa;}&#xa;&#xa;&lt;span style=&quot;box-sizing: border-box; color: rgb(227, 98, 9);&quot; class=&quot;hljs-built_in&quot;&gt;public&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;User&lt;/span&gt; register(&#xa;  @&lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;NotNull&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-type&quot;&gt;Name&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-type&quot;&gt;name&lt;/span&gt;,&#xa;  @&lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;NotNull&lt;/span&gt; PhoneNumber phone,&#xa;  @&lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;NotNull&lt;/span&gt; Address address&#xa;) {&#xa;    // 找到区域内的SalesRep&#xa;    SalesRep rep = salesRepRepo.findRep(phone.getAreaCode());&#xa;&#xa;    // 最后创建用户，落盘，然后返回，这部分代码实际上也能用Builder解决&#xa;    &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;User&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;user&lt;/span&gt; = &lt;span style=&quot;box-sizing: border-box; color: rgb(227, 98, 9);&quot; class=&quot;hljs-built_in&quot;&gt;new&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;User&lt;/span&gt;();&#xa;    &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;user&lt;/span&gt;.name = &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-type&quot;&gt;name&lt;/span&gt;;&#xa;    &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;user&lt;/span&gt;.phone = phone;&#xa;    &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;user&lt;/span&gt;.address = address;&#xa;    &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (rep != &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;) {&#xa;        &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;user&lt;/span&gt;.repId = rep.repId;&#xa;    }&#xa;&#xa;    &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; userRepo.saveUser(&lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;user&lt;/span&gt;);&#xa;}&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;fontSize=14;fontFamily=Helvetica;" vertex="1" parent="1">
          <mxGeometry x="1210" y="100" width="470" height="570" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-26" value="&lt;span style=&quot;box-sizing: border-box; font-weight: bolder; color: rgb(33, 37, 41); font-family: system-ui, -apple-system, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Helvetica Neue&amp;quot;, Arial, &amp;quot;Noto Sans&amp;quot;, &amp;quot;Liberation Sans&amp;quot;, sans-serif, &amp;quot;Apple Color Emoji&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;Segoe UI Symbol&amp;quot;, &amp;quot;Noto Color Emoji&amp;quot;; font-size: 16px; background-color: rgb(255, 255, 255);&quot;&gt;将 隐性的 上下文 显性化&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fontFamily=Helvetica;fontSize=14;align=left;" vertex="1" parent="1">
          <mxGeometry x="300" y="710" width="210" height="60" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-28" value="&lt;pre style=&quot;box-sizing: border-box; font-family: var(--bs-font-monospace); font-size: 0.875em; direction: ltr; unicode-bidi: bidi-override; display: block; margin-bottom: 1.25rem; overflow: auto; background: rgb(233, 236, 239); padding: 1rem; max-height: 35rem; line-height: 1.5; position: relative; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; margin-top: 0px !important; color: rgb(36, 41, 46);&quot; class=&quot;hljs language-kotlin&quot;&gt;金额与货币类型 封装为DP&lt;/pre&gt;&lt;pre style=&quot;box-sizing: border-box; font-family: var(--bs-font-monospace); font-size: 0.875em; direction: ltr; unicode-bidi: bidi-override; display: block; margin-top: 0px !important; margin-bottom: 1.25rem; overflow: auto; color: rgb(36, 41, 46); background: rgb(233, 236, 239); padding: 1rem; max-height: 35rem; line-height: 1.5; position: relative; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot; class=&quot;hljs language-kotlin&quot;&gt;&lt;span style=&quot;box-sizing: border-box; color: rgb(0, 92, 197);&quot; class=&quot;hljs-meta&quot;&gt;@Value&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-class&quot;&gt;&lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot; class=&quot;hljs-title&quot;&gt;Money&lt;/span&gt; &lt;/span&gt;{&lt;br&gt;    &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; BigDecimal amount;&lt;br&gt;    &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Currency currency;&lt;br&gt;    &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; Money(BigDecimal amount, Currency currency) {&lt;br&gt;        &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.amount = amount;&lt;br&gt;        &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.currency = currency;&lt;br&gt;    }&lt;br&gt;}&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;fontSize=14;fontFamily=Helvetica;" vertex="1" parent="1">
          <mxGeometry x="841" y="750" width="380" height="240" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-29" value="&lt;span style=&quot;box-sizing: border-box; font-weight: bolder; color: rgb(33, 37, 41); font-family: system-ui, -apple-system, &amp;quot;Segoe UI&amp;quot;, Roboto, &amp;quot;Helvetica Neue&amp;quot;, Arial, &amp;quot;Noto Sans&amp;quot;, &amp;quot;Liberation Sans&amp;quot;, sans-serif, &amp;quot;Apple Color Emoji&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;Segoe UI Symbol&amp;quot;, &amp;quot;Noto Color Emoji&amp;quot;; font-size: 16px; background-color: rgb(255, 255, 255);&quot;&gt;封装 多对象 行为&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fontFamily=Helvetica;fontSize=14;align=left;" vertex="1" parent="1">
          <mxGeometry x="300" y="770" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-30" value="&lt;pre style=&quot;box-sizing: border-box; font-family: var(--bs-font-monospace); font-size: 0.875em; direction: ltr; unicode-bidi: bidi-override; display: block; margin-top: 0px !important; margin-bottom: 1.25rem; overflow: auto; color: rgb(36, 41, 46); background: rgb(233, 236, 239); padding: 1rem; max-height: 35rem; line-height: 1.5; position: relative; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot; class=&quot;hljs language-reasonml&quot;&gt;转帐汇率计算功能 封装为DP&lt;/pre&gt;&lt;pre style=&quot;box-sizing: border-box; font-family: var(--bs-font-monospace); font-size: 0.875em; direction: ltr; unicode-bidi: bidi-override; display: block; margin-top: 0px !important; margin-bottom: 1.25rem; overflow: auto; color: rgb(36, 41, 46); background: rgb(233, 236, 239); padding: 1rem; max-height: 35rem; line-height: 1.5; position: relative; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot; class=&quot;hljs language-reasonml&quot;&gt;@Value&lt;br&gt;public &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; ExchangeRate {&lt;br&gt;    &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; BigDecimal rate;&lt;br&gt;    &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Currency from;&lt;br&gt;    &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Currency &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;to&lt;/span&gt;;&lt;br&gt;&lt;br&gt;    public &lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-constructor&quot;&gt;ExchangeRate(BigDecimal &lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-params&quot;&gt;rate&lt;/span&gt;, Currency &lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-params&quot;&gt;from&lt;/span&gt;, Currency &lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-params&quot;&gt;to&lt;/span&gt;)&lt;/span&gt; {&lt;br&gt;        this.rate = rate;&lt;br&gt;        this.from = from;&lt;br&gt;        this.&lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;to&lt;/span&gt; = &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;to&lt;/span&gt;;&lt;br&gt;    }&lt;br&gt;&lt;br&gt;    public Money exchange(Money fromMoney) {&lt;br&gt;        not&lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-constructor&quot;&gt;Null(&lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-params&quot;&gt;fromMoney&lt;/span&gt;)&lt;/span&gt;;&lt;br&gt;        is&lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-constructor&quot;&gt;True(&lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-params&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-params&quot;&gt;from&lt;/span&gt;.&lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-params&quot;&gt;equals&lt;/span&gt;(&lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-params&quot;&gt;fromMoney&lt;/span&gt;.&lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-params&quot;&gt;getCurrency&lt;/span&gt;()&lt;/span&gt;));&lt;br&gt;        BigDecimal targetAmount = fromMoney.get&lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-constructor&quot;&gt;Amount()&lt;/span&gt;.multiply(rate);&lt;br&gt;        return &lt;span style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot; class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-constructor&quot;&gt;Money(&lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-params&quot;&gt;targetAmount&lt;/span&gt;, &lt;span style=&quot;box-sizing: border-box;&quot; class=&quot;hljs-params&quot;&gt;to&lt;/span&gt;)&lt;/span&gt;;&lt;br&gt;    }&lt;br&gt;}&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;fontSize=14;fontFamily=Helvetica;" vertex="1" parent="1">
          <mxGeometry x="841" y="1040" width="450" height="420" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-35" value="" style="endArrow=none;dashed=1;html=1;rounded=0;sketch=1;fontFamily=Helvetica;fontSize=14;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;" edge="1" parent="1" source="xhAw2geh87z7_WKdA8rC-26" target="xhAw2geh87z7_WKdA8rC-28">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="630" y="950" as="sourcePoint" />
            <mxPoint x="830" y="740" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-36" value="" style="endArrow=none;dashed=1;html=1;rounded=0;sketch=1;fontFamily=Helvetica;fontSize=14;entryX=1;entryY=0.5;entryDx=0;entryDy=0;exitX=-0.009;exitY=0.119;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" source="xhAw2geh87z7_WKdA8rC-30" target="xhAw2geh87z7_WKdA8rC-29">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="510" y="970" as="sourcePoint" />
            <mxPoint x="560" y="920" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-38" value="" style="endArrow=none;dashed=1;html=1;rounded=0;sketch=1;fontFamily=Helvetica;fontSize=14;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="xhAw2geh87z7_WKdA8rC-18">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="640" y="630" as="sourcePoint" />
            <mxPoint x="830" y="420" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-42" value="接口参数是否容易混淆" style="ellipse;whiteSpace=wrap;html=1;fontSize=14;align=left;rounded=1;sketch=1;" vertex="1" parent="1">
          <mxGeometry x="500" y="315" width="190" height="70" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-44" value="方法是否参杂业务无法的判断" style="ellipse;whiteSpace=wrap;html=1;fontSize=14;align=left;rounded=1;sketch=1;" vertex="1" parent="1">
          <mxGeometry x="550" y="380" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-46" value="业务是否包含无关的逻辑" style="ellipse;whiteSpace=wrap;html=1;fontSize=14;align=left;rounded=1;sketch=1;" vertex="1" parent="1">
          <mxGeometry x="575" y="440" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-48" value="测试案例是否为指数性增加" style="ellipse;whiteSpace=wrap;html=1;fontSize=14;align=left;rounded=1;sketch=1;" vertex="1" parent="1">
          <mxGeometry x="510" y="500" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-63" value="" style="shape=table;html=1;whiteSpace=wrap;startSize=0;container=1;collapsible=0;childLayout=tableLayout;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="60" y="1140" width="530" height="311" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-64" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="xhAw2geh87z7_WKdA8rC-63">
          <mxGeometry width="530" height="78" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-65" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="xhAw2geh87z7_WKdA8rC-64">
          <mxGeometry width="130" height="78" as="geometry">
            <mxRectangle width="130" height="78" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-66" value="DTO" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="xhAw2geh87z7_WKdA8rC-64">
          <mxGeometry x="130" width="224" height="78" as="geometry">
            <mxRectangle width="224" height="78" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-67" value="PO" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="xhAw2geh87z7_WKdA8rC-64">
          <mxGeometry x="354" width="176" height="78" as="geometry">
            <mxRectangle width="176" height="78" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-68" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="xhAw2geh87z7_WKdA8rC-63">
          <mxGeometry y="78" width="530" height="77" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-69" value="功能" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="xhAw2geh87z7_WKdA8rC-68">
          <mxGeometry width="130" height="77" as="geometry">
            <mxRectangle width="130" height="77" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-70" value="数据传输" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="xhAw2geh87z7_WKdA8rC-68">
          <mxGeometry x="130" width="224" height="77" as="geometry">
            <mxRectangle width="224" height="77" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-71" value="代表业务域中的概念" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="xhAw2geh87z7_WKdA8rC-68">
          <mxGeometry x="354" width="176" height="77" as="geometry">
            <mxRectangle width="176" height="77" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-72" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="xhAw2geh87z7_WKdA8rC-63">
          <mxGeometry y="155" width="530" height="78" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-73" value="数据的关联" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="xhAw2geh87z7_WKdA8rC-72">
          <mxGeometry width="130" height="78" as="geometry">
            <mxRectangle width="130" height="78" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-74" value="无关联，按需存放数据" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="xhAw2geh87z7_WKdA8rC-72">
          <mxGeometry x="130" width="224" height="78" as="geometry">
            <mxRectangle width="224" height="78" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-75" value="数据之间高相关性" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;pointerEvents=1;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="xhAw2geh87z7_WKdA8rC-72">
          <mxGeometry x="354" width="176" height="78" as="geometry">
            <mxRectangle width="176" height="78" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-76" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="xhAw2geh87z7_WKdA8rC-63">
          <mxGeometry y="233" width="530" height="78" as="geometry" />
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-77" value="行为&lt;span style=&quot;white-space: pre;&quot;&gt;&lt;/span&gt;" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="xhAw2geh87z7_WKdA8rC-76">
          <mxGeometry width="130" height="78" as="geometry">
            <mxRectangle width="130" height="78" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-78" value="无行为" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="xhAw2geh87z7_WKdA8rC-76">
          <mxGeometry x="130" width="224" height="78" as="geometry">
            <mxRectangle width="224" height="78" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="xhAw2geh87z7_WKdA8rC-79" value="拥有业务域的行为逻辑" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;pointerEvents=1;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="xhAw2geh87z7_WKdA8rC-76">
          <mxGeometry x="354" width="176" height="78" as="geometry">
            <mxRectangle width="176" height="78" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="e6WRcSk255Bg2cV_zGF1" name="Entity &amp; Domain Service">
    <mxGraphModel dx="541" dy="351" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="JNcnS_u63ziuaeYBeUZ9-3" value="&lt;br&gt;由外部依赖的变化导致内部系统改造的程度判断代码的可维护性" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="330" y="440" width="350" height="120" as="geometry" />
        </mxCell>
        <UserObject label="参考文章" link="https://zhuanlan.zhihu.com/p/343388831" id="ubuPuly70hXiZkEZ4ams-1">
          <mxCell style="fontColor=#0000EE;fontStyle=4;rounded=1;overflow=hidden;spacing=10;sketch=1;" vertex="1" parent="1">
            <mxGeometry x="130" y="90" width="150" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="wv85PT69GQOxw_p691W_-2" value="Entity 领域实体类&lt;br&gt;&lt;br&gt;拥有状态、可以内聚DP" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="360" y="50" width="290" height="110" as="geometry" />
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-1" value="" style="shape=table;html=1;whiteSpace=wrap;startSize=0;container=1;collapsible=0;childLayout=tableLayout;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="240" y="1100" width="530" height="311" as="geometry" />
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-2" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="oEX1PyAN_TCCJpofBaqS-1">
          <mxGeometry width="530" height="78" as="geometry" />
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-3" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="oEX1PyAN_TCCJpofBaqS-2">
          <mxGeometry width="130" height="78" as="geometry">
            <mxRectangle width="130" height="78" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-4" value="数据库DO" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="oEX1PyAN_TCCJpofBaqS-2">
          <mxGeometry x="130" width="224" height="78" as="geometry">
            <mxRectangle width="224" height="78" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-5" value="领域Entity" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="oEX1PyAN_TCCJpofBaqS-2">
          <mxGeometry x="354" width="176" height="78" as="geometry">
            <mxRectangle width="176" height="78" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-6" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="oEX1PyAN_TCCJpofBaqS-1">
          <mxGeometry y="78" width="530" height="77" as="geometry" />
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-7" value="功能" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="oEX1PyAN_TCCJpofBaqS-6">
          <mxGeometry width="130" height="77" as="geometry">
            <mxRectangle width="130" height="77" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-8" value="单纯的数据库表映射" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="oEX1PyAN_TCCJpofBaqS-6">
          <mxGeometry x="130" width="224" height="77" as="geometry">
            <mxRectangle width="224" height="77" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-9" value="&lt;span style=&quot;color: rgb(18, 18, 18); font-family: -apple-system, &amp;quot;system-ui&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, &amp;quot;Source Han Sans SC&amp;quot;, &amp;quot;Noto Sans CJK SC&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, sans-serif; font-size: medium; text-align: left; background-color: rgb(255, 255, 255);&quot;&gt;领域逻辑的实体类&lt;/span&gt;" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="oEX1PyAN_TCCJpofBaqS-6">
          <mxGeometry x="354" width="176" height="77" as="geometry">
            <mxRectangle width="176" height="77" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-10" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="oEX1PyAN_TCCJpofBaqS-1">
          <mxGeometry y="155" width="530" height="78" as="geometry" />
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-11" value="数据的关联" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="oEX1PyAN_TCCJpofBaqS-10">
          <mxGeometry width="130" height="78" as="geometry">
            <mxRectangle width="130" height="78" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-12" value="&lt;span style=&quot;color: rgb(18, 18, 18); font-family: -apple-system, &amp;quot;system-ui&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, &amp;quot;Source Han Sans SC&amp;quot;, &amp;quot;Noto Sans CJK SC&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, sans-serif; font-size: medium; text-align: left; background-color: rgb(255, 255, 255);&quot;&gt;每个字段对应表的&lt;/span&gt;&lt;span style=&quot;color: rgb(18, 18, 18); font-family: -apple-system, &amp;quot;system-ui&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, &amp;quot;Source Han Sans SC&amp;quot;, &amp;quot;Noto Sans CJK SC&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, sans-serif; font-size: medium; text-align: left; background-color: rgb(255, 255, 255);&quot;&gt;column&lt;/span&gt;" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="oEX1PyAN_TCCJpofBaqS-10">
          <mxGeometry x="130" width="224" height="78" as="geometry">
            <mxRectangle width="224" height="78" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-13" value="数据之间高相关性" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;pointerEvents=1;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="oEX1PyAN_TCCJpofBaqS-10">
          <mxGeometry x="354" width="176" height="78" as="geometry">
            <mxRectangle width="176" height="78" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-14" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="oEX1PyAN_TCCJpofBaqS-1">
          <mxGeometry y="233" width="530" height="78" as="geometry" />
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-15" value="行为&lt;span style=&quot;white-space: pre;&quot;&gt;&lt;/span&gt;" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="oEX1PyAN_TCCJpofBaqS-14">
          <mxGeometry width="130" height="78" as="geometry">
            <mxRectangle width="130" height="78" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-16" value="无行为" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="oEX1PyAN_TCCJpofBaqS-14">
          <mxGeometry x="130" width="224" height="78" as="geometry">
            <mxRectangle width="224" height="78" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-17" value="拥有业务域的行为逻辑" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;pointerEvents=1;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="oEX1PyAN_TCCJpofBaqS-14">
          <mxGeometry x="354" width="176" height="78" as="geometry">
            <mxRectangle width="176" height="78" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-18" value="对外部依赖的耦合，外部依赖的不合理会腐蚀内部系统，这时引入了一个防腐层（ACL）的概念，用来&lt;span style=&quot;color: rgb(18, 18, 18); font-size: 14px; text-align: start; background-color: rgb(255, 255, 255);&quot;&gt;有效的隔离外部依赖和内部逻辑。&lt;br&gt;功能：&lt;/span&gt;&lt;span style=&quot;color: rgb(18, 18, 18); font-family: -apple-system, &amp;quot;system-ui&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, &amp;quot;Source Han Sans SC&amp;quot;, &amp;quot;Noto Sans CJK SC&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, sans-serif; font-size: medium; text-align: left; background-color: rgb(255, 255, 255);&quot;&gt;适配器、缓存、兜底、易测试&lt;/span&gt;&lt;span style=&quot;color: rgb(18, 18, 18); font-size: 14px; text-align: start; background-color: rgb(255, 255, 255);&quot;&gt;&lt;br&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="340" y="620" width="330" height="120" as="geometry" />
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-19" value="&lt;br&gt;由内部逻辑的变化导致内部系统改造的程度判断代码的可拓展性" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="330" y="320" width="350" height="120" as="geometry" />
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-20" value="Domain Service&lt;br&gt;&lt;br&gt;涉及多个Entity状态改变的服务" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="360" y="160" width="290" height="110" as="geometry" />
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-21" value="&lt;span style=&quot;font-weight: 600; font-synthesis: style; color: rgb(18, 18, 18); font-family: -apple-system, &amp;quot;system-ui&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, &amp;quot;Source Han Sans SC&amp;quot;, &amp;quot;Noto Sans CJK SC&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, sans-serif; font-size: medium; text-align: start; background-color: rgb(255, 255, 255);&quot;&gt;用Domain Primitive封装跟实体无关的无状态计算逻辑&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="280" y="830" width="430" height="60" as="geometry" />
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-22" value="&lt;h3 style=&quot;margin: calc(1.90909em) 0px calc(1.27273em); font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; font-size: 1.1em; line-height: 1.5; font-family: -apple-system, &amp;quot;system-ui&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, &amp;quot;Source Han Sans SC&amp;quot;, &amp;quot;Noto Sans CJK SC&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, sans-serif; clear: left; font-synthesis: style; color: rgb(18, 18, 18); text-align: start; background-color: rgb(255, 255, 255);&quot;&gt;&lt;span style=&quot;font-synthesis: style;&quot;&gt;用Entity封装单对象的有状态的行为，包括业务校验&lt;/span&gt;&lt;/h3&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="280" y="890" width="430" height="60" as="geometry" />
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-23" value="&lt;h3 style=&quot;margin: calc(1.90909em) 0px calc(1.27273em); font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: 1.5; clear: left; font-synthesis: style; text-align: start; background-color: rgb(255, 255, 255);&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Helvetica Neue, PingFang SC, Microsoft YaHei, Source Han Sans SC, Noto Sans CJK SC, WenQuanYi Micro Hei, sans-serif&quot; color=&quot;#121212&quot;&gt;&lt;span style=&quot;font-size: 15.4px;&quot;&gt;用Domain Service封装多对象逻辑&lt;/span&gt;&lt;/font&gt;&lt;/h3&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;fontFamily=Helvetica;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="280" y="950" width="430" height="60" as="geometry" />
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-24" value="" style="shape=image;verticalLabelPosition=bottom;labelBackgroundColor=default;verticalAlign=top;aspect=fixed;imageAspect=0;image=https://pic1.zhimg.com/v2-44ebd98e1697c75e119aa1d94a8f7768_r.jpg;" vertex="1" parent="1">
          <mxGeometry x="1950" y="110" width="520" height="284" as="geometry" />
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-25" value="" style="shape=image;verticalLabelPosition=bottom;labelBackgroundColor=default;verticalAlign=top;aspect=fixed;imageAspect=0;image=https://pic3.zhimg.com/v2-5182bc6ecf7fe977b5968d9181a414aa_r.jpg;" vertex="1" parent="1">
          <mxGeometry x="1940" y="570" width="520" height="282" as="geometry" />
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-26" value="&lt;meta charset=&quot;utf-8&quot;&gt;&lt;pre style=&quot;margin: 0px; padding: calc(0.888889em); font-size: 0.9em; word-break: initial; overflow-wrap: initial; overflow: auto; background: rgb(246, 246, 246); border-radius: 4px; color: rgb(18, 18, 18); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;code style=&quot;margin: 0px; padding: 0px; border-radius: 0px; font-family: Menlo, Monaco, Consolas, &amp;quot;Andale Mono&amp;quot;, &amp;quot;lucida console&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace; font-size: inherit; background-color: inherit;&quot; class=&quot;language-text&quot;&gt;public class TransferServiceImplNew implements TransferService {&#xa;&#xa;    private AccountRepository accountRepository;&#xa;    private AuditMessageProducer auditMessageProducer;&#xa;    private ExchangeRateService exchangeRateService;&#xa;    private AccountTransferService accountTransferService;&#xa;&#xa;    @Override&#xa;    public Result&amp;lt;Boolean&amp;gt; transfer(Long sourceUserId, String targetAccountNumber, BigDecimal targetAmount, String targetCurrency) {&#xa;        // 参数校验&#xa;        Money targetMoney = new Money(targetAmount, new Currency(targetCurrency));&#xa;&#xa;        // 读数据&#xa;        Account sourceAccount = accountRepository.find(new UserId(sourceUserId));&#xa;        Account targetAccount = accountRepository.find(new AccountNumber(targetAccountNumber));&#xa;        ExchangeRate exchangeRate = exchangeRateService.getExchangeRate(sourceAccount.getCurrency(), targetMoney.getCurrency());&#xa;&#xa;        // 业务逻辑&#xa;        accountTransferService.transfer(sourceAccount, targetAccount, targetMoney, exchangeRate);&#xa;&#xa;        // 保存数据&#xa;        accountRepository.save(sourceAccount);&#xa;        accountRepository.save(targetAccount);&#xa;&#xa;        // 发送审计消息&#xa;        AuditMessage message = new AuditMessage(sourceAccount, targetAccount, targetMoney);&#xa;        auditMessageProducer.send(message);&#xa;&#xa;        return Result.success(true);&#xa;    }&#xa;}&lt;/code&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;fontSize=14;fontFamily=Helvetica;" vertex="1" parent="1">
          <mxGeometry x="880" y="1060" width="1020" height="500" as="geometry" />
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-29" value="改造后" style="edgeStyle=orthogonalEdgeStyle;rounded=0;sketch=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontFamily=Helvetica;fontSize=14;" edge="1" parent="1" source="oEX1PyAN_TCCJpofBaqS-28" target="oEX1PyAN_TCCJpofBaqS-26">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oEX1PyAN_TCCJpofBaqS-28" value="&lt;meta charset=&quot;utf-8&quot;&gt;&lt;pre style=&quot;margin: 0px; padding: calc(0.888889em); font-size: 0.9em; word-break: initial; overflow-wrap: initial; overflow: auto; background: rgb(246, 246, 246); border-radius: 4px; color: rgb(18, 18, 18); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;code style=&quot;margin: 0px; padding: 0px; border-radius: 0px; font-family: Menlo, Monaco, Consolas, &amp;quot;Andale Mono&amp;quot;, &amp;quot;lucida console&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace; font-size: inherit; background-color: inherit;&quot; class=&quot;language-text&quot;&gt;public class TransferController {&#xa;&#xa;    private TransferService transferService;&#xa;&#xa;    public Result&amp;lt;Boolean&amp;gt; transfer(String targetAccountNumber, BigDecimal amount, HttpSession session) {&#xa;        Long userId = (Long) session.getAttribute(&quot;userId&quot;);&#xa;        return transferService.transfer(userId, targetAccountNumber, amount, &quot;CNY&quot;);&#xa;    }&#xa;}&#xa;&#xa;public class TransferServiceImpl implements TransferService {&#xa;&#xa;    private static final String TOPIC_AUDIT_LOG = &quot;TOPIC_AUDIT_LOG&quot;;&#xa;    private AccountMapper accountDAO;&#xa;    private KafkaTemplate&amp;lt;String, String&amp;gt; kafkaTemplate;&#xa;    private YahooForexService yahooForex;&#xa;&#xa;    @Override&#xa;    public Result&amp;lt;Boolean&amp;gt; transfer(Long sourceUserId, String targetAccountNumber, BigDecimal targetAmount, String targetCurrency) {&#xa;        // 1. 从数据库读取数据，忽略所有校验逻辑如账号是否存在等&#xa;        AccountDO sourceAccountDO = accountDAO.selectByUserId(sourceUserId);&#xa;        AccountDO targetAccountDO = accountDAO.selectByAccountNumber(targetAccountNumber);&#xa;&#xa;        // 2. 业务参数校验&#xa;        if (!targetAccountDO.getCurrency().equals(targetCurrency)) {&#xa;            throw new InvalidCurrencyException();&#xa;        }&#xa;&#xa;        // 3. 获取外部数据，并且包含一定的业务逻辑&#xa;        // exchange rate = 1 source currency = X target currency&#xa;        BigDecimal exchangeRate = BigDecimal.ONE;&#xa;        if (sourceAccountDO.getCurrency().equals(targetCurrency)) {&#xa;            exchangeRate = yahooForex.getExchangeRate(sourceAccountDO.getCurrency(), targetCurrency);&#xa;        }&#xa;        BigDecimal sourceAmount = targetAmount.divide(exchangeRate, RoundingMode.DOWN);&#xa;&#xa;        // 4. 业务参数校验&#xa;        if (sourceAccountDO.getAvailable().compareTo(sourceAmount) &amp;lt; 0) {&#xa;            throw new InsufficientFundsException();&#xa;        }&#xa;&#xa;        if (sourceAccountDO.getDailyLimit().compareTo(sourceAmount) &amp;lt; 0) {&#xa;            throw new DailyLimitExceededException();&#xa;        }&#xa;&#xa;        // 5. 计算新值，并且更新字段&#xa;        BigDecimal newSource = sourceAccountDO.getAvailable().subtract(sourceAmount);&#xa;        BigDecimal newTarget = targetAccountDO.getAvailable().add(targetAmount);&#xa;        sourceAccountDO.setAvailable(newSource);&#xa;        targetAccountDO.setAvailable(newTarget);&#xa;&#xa;        // 6. 更新到数据库&#xa;        accountDAO.update(sourceAccountDO);&#xa;        accountDAO.update(targetAccountDO);&#xa;&#xa;        // 7. 发送审计消息&#xa;        String message = sourceUserId + &quot;,&quot; + targetAccountNumber + &quot;,&quot; + targetAmount + &quot;,&quot; + targetCurrency;&#xa;        kafkaTemplate.send(TOPIC_AUDIT_LOG, message);&#xa;&#xa;        return Result.success(true);&#xa;    }&#xa;&#xa;}&lt;/code&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;fontSize=14;fontFamily=Helvetica;" vertex="1" parent="1">
          <mxGeometry x="880" width="1030" height="970" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
