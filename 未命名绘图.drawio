<mxfile host="app.diagrams.net" modified="2022-11-25T10:11:56.379Z" agent="5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36" etag="JqZ17DlvjUIGSyPg8BEa" version="20.3.6" type="github">
  <diagram id="nQzbI4wFkc12O309aEYU" name="第 1 页">
    <mxGraphModel dx="3195" dy="2145" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="Jl6kpFa6PzPxEvhcqufj-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="Jl6kpFa6PzPxEvhcqufj-1" target="Jl6kpFa6PzPxEvhcqufj-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Jl6kpFa6PzPxEvhcqufj-1" value="&lt;pre style=&quot;background-color: rgb(43, 43, 43); font-family: &amp;quot;JetBrains Mono&amp;quot;, monospace; font-size: 10.5pt;&quot;&gt;&lt;pre style=&quot;color: rgb(169, 183, 198); font-family: &amp;quot;JetBrains Mono&amp;quot;, monospace; font-size: 10.5pt;&quot;&gt;&lt;span style=&quot;color:#bbb529;&quot;&gt;@Configuration&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;proxyBeanMethods = &lt;span style=&quot;color:#cc7832;&quot;&gt;false&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;class &lt;/span&gt;HttpSecurityConfiguration &lt;span style=&quot;color:#e8ba36;&quot;&gt;{&lt;/span&gt;&lt;/pre&gt;&lt;pre style=&quot;color: rgb(169, 183, 198); font-family: &amp;quot;JetBrains Mono&amp;quot;, monospace; font-size: 10.5pt;&quot;&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;// HttpSecurity 是原型模式 当每次需要到的时候 都是一个新的 http安全对象&lt;/span&gt;&lt;/pre&gt;&lt;pre style=&quot;color: rgb(169, 183, 198); font-family: &amp;quot;JetBrains Mono&amp;quot;, monospace; font-size: 10.5pt;&quot;&gt;&lt;span style=&quot;color:#bbb529;&quot;&gt;@Bean&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#9876aa;font-style:italic;&quot;&gt;HTTPSECURITY_BEAN_NAME&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bbb529;&quot;&gt;@Scope&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6a8759;&quot;&gt;&quot;prototype&quot;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;HttpSecurity &lt;span style=&quot;color:#ffc66d;&quot;&gt;httpSecurity&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;() &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;throws &lt;/span&gt;Exception &lt;span style=&quot;color:#54a857;&quot;&gt;{&lt;/span&gt;&lt;/pre&gt;&lt;pre style=&quot;color: rgb(169, 183, 198); font-family: &amp;quot;JetBrains Mono&amp;quot;, monospace; font-size: 10.5pt;&quot;&gt;&lt;span style=&quot;&quot;&gt; &lt;/span&gt;//  创建  AuthenticationManagerBuilder&lt;/pre&gt;&lt;pre style=&quot;color: rgb(169, 183, 198); font-family: &amp;quot;JetBrains Mono&amp;quot;, monospace; font-size: 10.5pt;&quot;&gt;&lt;span style=&quot;&quot;&gt; &lt;/span&gt;authenticationBuilder.parentAuthenticationManager&lt;span style=&quot;font-size: 10.5pt; color: rgb(232, 186, 54);&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-size: 10.5pt;&quot;&gt;authenticationManager&lt;/span&gt;&lt;span style=&quot;font-size: 10.5pt; color: rgb(84, 168, 87);&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;font-size: 10.5pt; color: rgb(232, 186, 54);&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;font-size: 10.5pt; color: rgb(204, 120, 50);&quot;&gt;;&lt;/span&gt;&lt;span style=&quot;font-size: 10.5pt;&quot;&gt;&lt;/span&gt;&lt;/pre&gt;&lt;pre style=&quot;font-family: &amp;quot;JetBrains Mono&amp;quot;, monospace; font-size: 10.5pt;&quot;&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;   &lt;/span&gt;&lt;font color=&quot;#a9b7c6&quot;&gt;HttpSecurity http = &lt;/font&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;new &lt;/span&gt;&lt;font color=&quot;#a9b7c6&quot;&gt;HttpSecurity&lt;/font&gt;&lt;span style=&quot;color: rgb(232, 186, 54);&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;this&lt;/span&gt;&lt;font color=&quot;#a9b7c6&quot;&gt;.&lt;/font&gt;&lt;span style=&quot;color: rgb(152, 118, 170);&quot;&gt;objectPostProcessor&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;, &lt;/span&gt;&lt;font color=&quot;#a9b7c6&quot;&gt;authenticationBuilder&lt;/font&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;, &lt;/span&gt;&lt;font color=&quot;#a9b7c6&quot;&gt;createSharedObjects&lt;/font&gt;&lt;span style=&quot;color: rgb(84, 168, 87);&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: rgb(232, 186, 54);&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;;&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;   &lt;span style=&quot;&quot;&gt; &lt;/span&gt;// 加载配置进 httpSecurity &lt;/span&gt;applyDefaultConfigurers&lt;span style=&quot;font-size: 10.5pt; color: rgb(232, 186, 54);&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: rgb(169, 183, 198); font-size: 10.5pt;&quot;&gt;http&lt;/span&gt;&lt;span style=&quot;font-size: 10.5pt; color: rgb(232, 186, 54);&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;font-size: 10.5pt; color: rgb(204, 120, 50);&quot;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;pre style=&quot;font-family: &amp;quot;JetBrains Mono&amp;quot;, monospace; font-size: 10.5pt;&quot;&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;&lt;span style=&quot;&quot;&gt; &lt;/span&gt;return &lt;/span&gt;&lt;font color=&quot;#a9b7c6&quot;&gt;http&lt;/font&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(84, 168, 87);&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;&lt;pre style=&quot;color: rgb(169, 183, 198); font-family: &amp;quot;JetBrains Mono&amp;quot;, monospace; font-size: 10.5pt;&quot;&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="40" y="80" width="960" height="370" as="geometry" />
        </mxCell>
        <mxCell id="Jl6kpFa6PzPxEvhcqufj-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="Jl6kpFa6PzPxEvhcqufj-3" target="Jl6kpFa6PzPxEvhcqufj-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Jl6kpFa6PzPxEvhcqufj-18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" parent="1" source="Jl6kpFa6PzPxEvhcqufj-3" target="Jl6kpFa6PzPxEvhcqufj-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Jl6kpFa6PzPxEvhcqufj-3" value="&lt;pre style=&quot;background-color:#2b2b2b;color:#a9b7c6;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:10.5pt;&quot;&gt;&lt;span style=&quot;color:#bbb529;&quot;&gt;自定义  @Bean&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bbb529;&quot;&gt;@Order&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;Ordered.&lt;span style=&quot;color:#9876aa;font-style:italic;&quot;&gt;HIGHEST_PRECEDENCE&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;public &lt;/span&gt;SecurityFilterChain &lt;span style=&quot;color:#ffc66d;&quot;&gt;authorizationServerSecurityFilterChain&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;HttpSecurity http&lt;span style=&quot;color:#e8ba36;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;throws &lt;/span&gt;Exception &lt;span style=&quot;color:#359ff4;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   return &lt;/span&gt;http.build&lt;span style=&quot;color:#e8ba36;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="40" y="450" width="890" height="110" as="geometry" />
        </mxCell>
        <mxCell id="Jl6kpFa6PzPxEvhcqufj-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="Jl6kpFa6PzPxEvhcqufj-7" target="Jl6kpFa6PzPxEvhcqufj-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Jl6kpFa6PzPxEvhcqufj-7" value="&lt;pre style=&quot;background-color:#2b2b2b;color:#a9b7c6;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:10.5pt;&quot;&gt;&lt;span style=&quot;color:#bbb529;&quot;&gt;@Autowired&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;required = &lt;span style=&quot;color:#cc7832;&quot;&gt;false&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;void &lt;/span&gt;&lt;span style=&quot;color:#ffc66d;&quot;&gt;setFilterChains&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;List&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;lt;&lt;/span&gt;SecurityFilterChain&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;gt; &lt;/span&gt;securityFilterChains&lt;span style=&quot;color:#e8ba36;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;securityFilterChains &lt;/span&gt;= securityFilterChains&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1060" y="560" width="560" height="120" as="geometry" />
        </mxCell>
        <mxCell id="Jl6kpFa6PzPxEvhcqufj-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" parent="1" source="Jl6kpFa6PzPxEvhcqufj-9" target="Jl6kpFa6PzPxEvhcqufj-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Jl6kpFa6PzPxEvhcqufj-9" value="&lt;meta charset=&quot;utf-8&quot;&gt;&lt;pre style=&quot;font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; background-color: rgb(43, 43, 43); color: rgb(169, 183, 198); font-family: &amp;quot;JetBrains Mono&amp;quot;, monospace; font-size: 10.5pt;&quot;&gt;&lt;span style=&quot;color: rgb(187, 181, 41);&quot;&gt;@Bean&lt;/span&gt;&lt;span style=&quot;color: rgb(232, 186, 54);&quot;&gt;(&lt;/span&gt;name = AbstractSecurityWebApplicationInitializer.&lt;span style=&quot;color: rgb(152, 118, 170); font-style: italic;&quot;&gt;DEFAULT_FILTER_NAME&lt;/span&gt;&lt;span style=&quot;color: rgb(232, 186, 54);&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;public &lt;/span&gt;Filter &lt;span style=&quot;color: rgb(255, 198, 109);&quot;&gt;springSecurityFilterChain&lt;/span&gt;&lt;span style=&quot;color: rgb(232, 186, 54);&quot;&gt;() &lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;throws &lt;/span&gt;Exception &lt;span style=&quot;color: rgb(84, 168, 87);&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(84, 168, 87);&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;boolean &lt;/span&gt;hasConfigurers = &lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color: rgb(152, 118, 170);&quot;&gt;webSecurityConfigurers &lt;/span&gt;!= &lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;null &lt;/span&gt;&amp;amp;&amp;amp; !&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color: rgb(152, 118, 170);&quot;&gt;webSecurityConfigurers&lt;/span&gt;.isEmpty&lt;span style=&quot;color: rgb(232, 186, 54);&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;   boolean &lt;/span&gt;hasFilterChain = !&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color: rgb(152, 118, 170);&quot;&gt;securityFilterChains&lt;/span&gt;.isEmpty&lt;span style=&quot;color: rgb(232, 186, 54);&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;   &lt;/span&gt;Assert.&lt;span style=&quot;font-style: italic;&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: rgb(232, 186, 54);&quot;&gt;(&lt;/span&gt;!&lt;span style=&quot;color: rgb(84, 168, 87);&quot;&gt;(&lt;/span&gt;hasConfigurers &amp;amp;&amp;amp; hasFilterChain&lt;span style=&quot;color: rgb(84, 168, 87);&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;         &lt;/span&gt;&lt;span style=&quot;color: rgb(106, 135, 89);&quot;&gt;&quot;Found WebSecurityConfigurerAdapter as well as SecurityFilterChain. Please select just one.&quot;&lt;/span&gt;&lt;span style=&quot;color: rgb(232, 186, 54);&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;   if &lt;/span&gt;&lt;span style=&quot;color: rgb(232, 186, 54);&quot;&gt;(&lt;/span&gt;!hasConfigurers &amp;amp;&amp;amp; !hasFilterChain&lt;span style=&quot;color: rgb(232, 186, 54);&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: rgb(53, 159, 244);&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(53, 159, 244);&quot;&gt;      &lt;/span&gt;WebSecurityConfigurerAdapter adapter = &lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color: rgb(152, 118, 170);&quot;&gt;objectObjectPostProcessor&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(152, 118, 170);&quot;&gt;            &lt;/span&gt;.postProcess&lt;span style=&quot;color: rgb(84, 168, 87);&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;new &lt;/span&gt;WebSecurityConfigurerAdapter&lt;span style=&quot;color: rgb(53, 159, 244);&quot;&gt;() &lt;/span&gt;&lt;span style=&quot;color: rgb(80, 96, 187);&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(80, 96, 187);&quot;&gt;            }&lt;/span&gt;&lt;span style=&quot;color: rgb(84, 168, 87);&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;      this&lt;/span&gt;.&lt;span style=&quot;color: rgb(152, 118, 170);&quot;&gt;webSecurity&lt;/span&gt;.apply&lt;span style=&quot;color: rgb(84, 168, 87);&quot;&gt;(&lt;/span&gt;adapter&lt;span style=&quot;color: rgb(84, 168, 87);&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color: rgb(53, 159, 244);&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(53, 159, 244);&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;for &lt;/span&gt;&lt;span style=&quot;color: rgb(232, 186, 54);&quot;&gt;(&lt;/span&gt;SecurityFilterChain securityFilterChain : &lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color: rgb(152, 118, 170);&quot;&gt;securityFilterChains&lt;/span&gt;&lt;span style=&quot;color: rgb(232, 186, 54);&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: rgb(53, 159, 244);&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(53, 159, 244);&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color: rgb(152, 118, 170);&quot;&gt;webSecurity&lt;/span&gt;.addSecurityFilterChainBuilder&lt;span style=&quot;color: rgb(84, 168, 87);&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: rgb(53, 159, 244);&quot;&gt;() &lt;/span&gt;-&amp;gt; &lt;span style=&quot;color: rgb(179, 137, 197);&quot;&gt;securityFilterChain&lt;/span&gt;&lt;span style=&quot;color: rgb(84, 168, 87);&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;      for &lt;/span&gt;&lt;span style=&quot;color: rgb(84, 168, 87);&quot;&gt;(&lt;/span&gt;Filter filter : securityFilterChain.getFilters&lt;span style=&quot;color: rgb(53, 159, 244);&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: rgb(84, 168, 87);&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: rgb(80, 96, 187);&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(80, 96, 187);&quot;&gt;         &lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color: rgb(53, 159, 244);&quot;&gt;(&lt;/span&gt;filter &lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;instanceof &lt;/span&gt;FilterSecurityInterceptor&lt;span style=&quot;color: rgb(53, 159, 244);&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: rgb(23, 147, 135);&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(23, 147, 135);&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color: rgb(152, 118, 170);&quot;&gt;webSecurity&lt;/span&gt;.securityInterceptor&lt;span style=&quot;color: rgb(80, 96, 187);&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: rgb(23, 147, 135);&quot;&gt;(&lt;/span&gt;FilterSecurityInterceptor&lt;span style=&quot;color: rgb(23, 147, 135);&quot;&gt;) &lt;/span&gt;filter&lt;span style=&quot;color: rgb(80, 96, 187);&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;            break;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;         &lt;/span&gt;&lt;span style=&quot;color: rgb(23, 147, 135);&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(23, 147, 135);&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: rgb(80, 96, 187);&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(80, 96, 187);&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color: rgb(53, 159, 244);&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(53, 159, 244);&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;for &lt;/span&gt;&lt;span style=&quot;color: rgb(232, 186, 54);&quot;&gt;(&lt;/span&gt;WebSecurityCustomizer customizer : &lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color: rgb(152, 118, 170);&quot;&gt;webSecurityCustomizers&lt;/span&gt;&lt;span style=&quot;color: rgb(232, 186, 54);&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: rgb(53, 159, 244);&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(53, 159, 244);&quot;&gt;      &lt;/span&gt;customizer.customize&lt;span style=&quot;color: rgb(84, 168, 87);&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color: rgb(152, 118, 170);&quot;&gt;webSecurity&lt;/span&gt;&lt;span style=&quot;color: rgb(84, 168, 87);&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color: rgb(53, 159, 244);&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(53, 159, 244);&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;return this&lt;/span&gt;.&lt;span style=&quot;color: rgb(152, 118, 170);&quot;&gt;webSecurity&lt;/span&gt;.build&lt;span style=&quot;color: rgb(232, 186, 54);&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: rgb(204, 120, 50);&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(84, 168, 87);&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1050" y="1040" width="560" height="490" as="geometry" />
        </mxCell>
        <mxCell id="Jl6kpFa6PzPxEvhcqufj-12" value="&lt;pre style=&quot;background-color:#2b2b2b;color:#a9b7c6;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:10.5pt;&quot;&gt;&lt;span style=&quot;color:#bbb529;&quot;&gt;@Override&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;protected &lt;/span&gt;Filter &lt;span style=&quot;color:#ffc66d;&quot;&gt;performBuild&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;() &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;throws &lt;/span&gt;Exception &lt;span style=&quot;color:#54a857;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   int &lt;/span&gt;chainSize = &lt;span style=&quot;color:#cc7832;&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;ignoredRequests&lt;/span&gt;.size&lt;span style=&quot;color:#e8ba36;&quot;&gt;() &lt;/span&gt;+ &lt;span style=&quot;color:#cc7832;&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;securityFilterChainBuilders&lt;/span&gt;.size&lt;span style=&quot;color:#e8ba36;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;List&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;lt;&lt;/span&gt;SecurityFilterChain&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;gt; &lt;/span&gt;securityFilterChains = &lt;span style=&quot;color:#cc7832;&quot;&gt;new &lt;/span&gt;ArrayList&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;lt;&amp;gt;(&lt;/span&gt;chainSize&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;List&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;lt;&lt;/span&gt;RequestMatcherEntry&lt;span style=&quot;color:#54a857;&quot;&gt;&amp;lt;&lt;/span&gt;List&lt;span style=&quot;color:#359ff4;&quot;&gt;&amp;lt;&lt;/span&gt;WebInvocationPrivilegeEvaluator&lt;span style=&quot;color:#359ff4;&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;gt; &lt;/span&gt;requestMatcherPrivilegeEvaluatorsEntries = &lt;span style=&quot;color:#cc7832;&quot;&gt;new &lt;/span&gt;ArrayList&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;lt;&amp;gt;()&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   for &lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;RequestMatcher ignoredRequest : &lt;span style=&quot;color:#cc7832;&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;ignoredRequests&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;      &lt;/span&gt;SecurityFilterChain securityFilterChain = &lt;span style=&quot;color:#cc7832;&quot;&gt;new &lt;/span&gt;DefaultSecurityFilterChain&lt;span style=&quot;color:#54a857;&quot;&gt;(&lt;/span&gt;ignoredRequest&lt;span style=&quot;color:#54a857;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;      &lt;/span&gt;securityFilterChains.add&lt;span style=&quot;color:#54a857;&quot;&gt;(&lt;/span&gt;securityFilterChain&lt;span style=&quot;color:#54a857;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;      &lt;/span&gt;requestMatcherPrivilegeEvaluatorsEntries&lt;br&gt;            .add&lt;span style=&quot;color:#54a857;&quot;&gt;(&lt;/span&gt;getRequestMatcherPrivilegeEvaluatorsEntry&lt;span style=&quot;color:#359ff4;&quot;&gt;(&lt;/span&gt;securityFilterChain&lt;span style=&quot;color:#359ff4;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;for &lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;SecurityBuilder&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;lt;&lt;/span&gt;? &lt;span style=&quot;color:#cc7832;&quot;&gt;extends &lt;/span&gt;SecurityFilterChain&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;gt; &lt;/span&gt;securityFilterChainBuilder : &lt;span style=&quot;color:#cc7832;&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;securityFilterChainBuilders&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;      &lt;/span&gt;SecurityFilterChain securityFilterChain = securityFilterChainBuilder.build&lt;span style=&quot;color:#54a857;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;      &lt;/span&gt;securityFilterChains.add&lt;span style=&quot;color:#54a857;&quot;&gt;(&lt;/span&gt;securityFilterChain&lt;span style=&quot;color:#54a857;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;      &lt;/span&gt;requestMatcherPrivilegeEvaluatorsEntries&lt;br&gt;            .add&lt;span style=&quot;color:#54a857;&quot;&gt;(&lt;/span&gt;getRequestMatcherPrivilegeEvaluatorsEntry&lt;span style=&quot;color:#359ff4;&quot;&gt;(&lt;/span&gt;securityFilterChain&lt;span style=&quot;color:#359ff4;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;   &lt;/span&gt;FilterChainProxy filterChainProxy = &lt;span style=&quot;color:#cc7832;&quot;&gt;new &lt;/span&gt;FilterChainProxy&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;securityFilterChains&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;Filter result = filterChainProxy&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   return &lt;/span&gt;result&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1590" y="1600" width="1190" height="430" as="geometry" />
        </mxCell>
        <mxCell id="Jl6kpFa6PzPxEvhcqufj-13" value="&lt;pre style=&quot;background-color:#2b2b2b;color:#a9b7c6;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:10.5pt;&quot;&gt;&lt;span style=&quot;color:#bbb529;&quot;&gt;@Configuration&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;proxyBeanMethods = &lt;span style=&quot;color:#cc7832;&quot;&gt;false&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;public class &lt;/span&gt;WebSecurityConfiguration &lt;span style=&quot;color:#cc7832;&quot;&gt;implements &lt;/span&gt;ImportAware&lt;span style=&quot;color:#cc7832;&quot;&gt;, &lt;/span&gt;BeanClassLoaderAware &lt;span style=&quot;color:#e8ba36;&quot;&gt;{&lt;/span&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1060" y="510" width="560" height="90" as="geometry" />
        </mxCell>
        <mxCell id="Jl6kpFa6PzPxEvhcqufj-14" value="&lt;pre style=&quot;background-color:#2b2b2b;color:#a9b7c6;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:10.5pt;&quot;&gt;&lt;span style=&quot;color:#bbb529;&quot;&gt;@Autowired&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;required = &lt;span style=&quot;color:#cc7832;&quot;&gt;false&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;public void &lt;/span&gt;&lt;span style=&quot;color:#ffc66d;&quot;&gt;setFilterChainProxySecurityConfigurer&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;ObjectPostProcessor&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;lt;&lt;/span&gt;Object&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;gt; &lt;/span&gt;objectPostProcessor&lt;span style=&quot;color:#cc7832;&quot;&gt;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;      &lt;/span&gt;ConfigurableListableBeanFactory beanFactory&lt;span style=&quot;color:#e8ba36;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;throws &lt;/span&gt;Exception &lt;span style=&quot;color:#54a857;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;webSecurity &lt;/span&gt;= objectPostProcessor.postProcess&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;new &lt;/span&gt;WebSecurity&lt;span style=&quot;color:#54a857;&quot;&gt;(&lt;/span&gt;objectPostProcessor&lt;span style=&quot;color:#54a857;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;   &lt;/span&gt;List&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;lt;&lt;/span&gt;SecurityConfigurer&lt;span style=&quot;color:#54a857;&quot;&gt;&amp;lt;&lt;/span&gt;Filter&lt;span style=&quot;color:#cc7832;&quot;&gt;, &lt;/span&gt;WebSecurity&lt;span style=&quot;color:#54a857;&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;gt; &lt;/span&gt;webSecurityConfigurers = &lt;span style=&quot;color:#cc7832;&quot;&gt;new &lt;/span&gt;AutowiredWebSecurityConfigurersIgnoreParents&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;         &lt;/span&gt;beanFactory&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;/span&gt;.getWebSecurityConfigurers&lt;span style=&quot;color:#e8ba36;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;webSecurityConfigurers.sort&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;AnnotationAwareOrderComparator.&lt;span style=&quot;color:#9876aa;font-style:italic;&quot;&gt;INSTANCE&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;Integer previousOrder = &lt;span style=&quot;color:#cc7832;&quot;&gt;null;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;Object previousConfig = &lt;span style=&quot;color:#cc7832;&quot;&gt;null;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   for &lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;SecurityConfigurer&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;lt;&lt;/span&gt;Filter&lt;span style=&quot;color:#cc7832;&quot;&gt;, &lt;/span&gt;WebSecurity&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;gt; &lt;/span&gt;config : webSecurityConfigurers&lt;span style=&quot;color:#e8ba36;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;      &lt;/span&gt;Integer order = AnnotationAwareOrderComparator.&lt;span style=&quot;font-style:italic;&quot;&gt;lookupOrder&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;(&lt;/span&gt;config&lt;span style=&quot;color:#54a857;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;/span&gt;&lt;span style=&quot;color:#5060bb;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#5060bb;&quot;&gt;      &lt;/span&gt;previousOrder = order&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;      &lt;/span&gt;previousConfig = config&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;for &lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;SecurityConfigurer&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;lt;&lt;/span&gt;Filter&lt;span style=&quot;color:#cc7832;&quot;&gt;, &lt;/span&gt;WebSecurity&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;gt; &lt;/span&gt;webSecurityConfigurer : webSecurityConfigurers&lt;span style=&quot;color:#e8ba36;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;webSecurity&lt;/span&gt;.apply&lt;span style=&quot;color:#54a857;&quot;&gt;(&lt;/span&gt;webSecurityConfigurer&lt;span style=&quot;color:#54a857;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;webSecurityConfigurers &lt;/span&gt;= webSecurityConfigurers&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1050" y="670" width="1050" height="370" as="geometry" />
        </mxCell>
        <mxCell id="Jl6kpFa6PzPxEvhcqufj-17" value="&lt;pre style=&quot;background-color:#2b2b2b;color:#a9b7c6;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:10.5pt;&quot;&gt;&lt;span style=&quot;color:#bbb529;&quot;&gt;@Override&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;public final &lt;/span&gt;&lt;span style=&quot;color:#507874;&quot;&gt;O &lt;/span&gt;&lt;span style=&quot;color:#ffc66d;&quot;&gt;build&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;() &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;throws &lt;/span&gt;Exception &lt;span style=&quot;color:#54a857;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;building&lt;/span&gt;.compareAndSet&lt;span style=&quot;color:#54a857;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;false, true&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;object &lt;/span&gt;= doBuild&lt;span style=&quot;color:#54a857;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;      return this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;object&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="40" y="610" width="700" height="130" as="geometry" />
        </mxCell>
        <mxCell id="Jl6kpFa6PzPxEvhcqufj-19" value="&lt;pre style=&quot;background-color:#2b2b2b;color:#a9b7c6;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:10.5pt;&quot;&gt;&lt;span style=&quot;color:#bbb529;&quot;&gt;@Override&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;protected final &lt;/span&gt;&lt;span style=&quot;color:#507874;&quot;&gt;O &lt;/span&gt;&lt;span style=&quot;color:#ffc66d;&quot;&gt;doBuild&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;() &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;throws &lt;/span&gt;Exception &lt;span style=&quot;color:#54a857;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;synchronized &lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;configurers&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;buildState &lt;/span&gt;= BuildState.&lt;span style=&quot;color:#9876aa;font-style:italic;&quot;&gt;INITIALIZING&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;      &lt;/span&gt;beforeInit&lt;span style=&quot;color:#54a857;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;      &lt;/span&gt;init&lt;span style=&quot;color:#54a857;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;      this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;buildState &lt;/span&gt;= BuildState.&lt;span style=&quot;color:#9876aa;font-style:italic;&quot;&gt;CONFIGURING&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;      &lt;/span&gt;beforeConfigure&lt;span style=&quot;color:#54a857;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;      &lt;/span&gt;configure&lt;span style=&quot;color:#54a857;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;      this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;buildState &lt;/span&gt;= BuildState.&lt;span style=&quot;color:#9876aa;font-style:italic;&quot;&gt;BUILDING&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color:#507874;&quot;&gt;O &lt;/span&gt;result = performBuild&lt;span style=&quot;color:#54a857;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;      this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;buildState &lt;/span&gt;= BuildState.&lt;span style=&quot;color:#9876aa;font-style:italic;&quot;&gt;BUILT&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;      return &lt;/span&gt;result&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="40" y="780" width="440" height="300" as="geometry" />
        </mxCell>
        <mxCell id="Jl6kpFa6PzPxEvhcqufj-23" value="&lt;pre style=&quot;background-color:#2b2b2b;color:#a9b7c6;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:10.5pt;&quot;&gt;&lt;span style=&quot;color:#bbb529;&quot;&gt;@Configuration&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;proxyBeanMethods = &lt;span style=&quot;color:#cc7832;&quot;&gt;false&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bbb529;&quot;&gt;@Import&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;ObjectPostProcessorConfiguration.&lt;span style=&quot;color:#cc7832;&quot;&gt;class&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;public class &lt;/span&gt;AuthenticationConfiguration &lt;span style=&quot;color:#e8ba36;&quot;&gt;{&lt;/span&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-1600" y="-470" width="430" height="100" as="geometry" />
        </mxCell>
        <mxCell id="Jl6kpFa6PzPxEvhcqufj-24" value="&lt;pre style=&quot;background-color:#2b2b2b;color:#a9b7c6;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:10.5pt;&quot;&gt;&lt;span style=&quot;color:#bbb529;&quot;&gt;@Bean&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;public &lt;/span&gt;AuthenticationManagerBuilder &lt;span style=&quot;color:#ffc66d;&quot;&gt;authenticationManagerBuilder&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;ObjectPostProcessor&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;lt;&lt;/span&gt;Object&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;gt; &lt;/span&gt;objectPostProcessor&lt;span style=&quot;color:#cc7832;&quot;&gt;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;      &lt;/span&gt;ApplicationContext context&lt;span style=&quot;color:#e8ba36;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;   &lt;/span&gt;LazyPasswordEncoder defaultPasswordEncoder = &lt;span style=&quot;color:#cc7832;&quot;&gt;new &lt;/span&gt;LazyPasswordEncoder&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;context&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;AuthenticationEventPublisher authenticationEventPublisher = &lt;span style=&quot;font-style:italic;&quot;&gt;getBeanOrNull&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;context&lt;span style=&quot;color:#cc7832;&quot;&gt;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;         &lt;/span&gt;AuthenticationEventPublisher.&lt;span style=&quot;color:#cc7832;&quot;&gt;class&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;DefaultPasswordEncoderAuthenticationManagerBuilder result = &lt;span style=&quot;color:#cc7832;&quot;&gt;new &lt;/span&gt;DefaultPasswordEncoderAuthenticationManagerBuilder&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;         &lt;/span&gt;objectPostProcessor&lt;span style=&quot;color:#cc7832;&quot;&gt;, &lt;/span&gt;defaultPasswordEncoder&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   if &lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;authenticationEventPublisher != &lt;span style=&quot;color:#cc7832;&quot;&gt;null&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;      &lt;/span&gt;result.authenticationEventPublisher&lt;span style=&quot;color:#54a857;&quot;&gt;(&lt;/span&gt;authenticationEventPublisher&lt;span style=&quot;color:#54a857;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;return &lt;/span&gt;result&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-1600" y="-410" width="560" height="270" as="geometry" />
        </mxCell>
        <mxCell id="Jl6kpFa6PzPxEvhcqufj-25" value="&lt;pre style=&quot;background-color:#2b2b2b;color:#a9b7c6;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:10.5pt;&quot;&gt;&lt;span style=&quot;color:#bbb529;&quot;&gt;@Override&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;protected &lt;/span&gt;ProviderManager &lt;span style=&quot;color:#ffc66d;&quot;&gt;performBuild&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;() &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;throws &lt;/span&gt;Exception &lt;span style=&quot;color:#54a857;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;!isConfigured&lt;span style=&quot;color:#54a857;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;logger&lt;/span&gt;.debug&lt;span style=&quot;color:#54a857;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6a8759;&quot;&gt;&quot;No authenticationProviders and no parentAuthenticationManager defined. Returning null.&quot;&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;      return null;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;   &lt;/span&gt;ProviderManager providerManager = &lt;span style=&quot;color:#cc7832;&quot;&gt;new &lt;/span&gt;ProviderManager&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;authenticationProviders&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;         this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;parentAuthenticationManager&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#359ff4;&quot;&gt;   &lt;/span&gt;providerManager = postProcess&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;providerManager&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   return &lt;/span&gt;providerManager&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-1600" y="-80" width="1150" height="260" as="geometry" />
        </mxCell>
        <mxCell id="Jl6kpFa6PzPxEvhcqufj-26" value="&lt;pre style=&quot;background-color:#2b2b2b;color:#a9b7c6;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:10.5pt;&quot;&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;public class &lt;/span&gt;AuthenticationManagerBuilder&lt;br&gt;      &lt;span style=&quot;color:#cc7832;&quot;&gt;extends &lt;/span&gt;AbstractConfiguredSecurityBuilder&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;lt;&lt;/span&gt;AuthenticationManager&lt;span style=&quot;color:#cc7832;&quot;&gt;, &lt;/span&gt;AuthenticationManagerBuilder&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;implements &lt;/span&gt;ProviderManagerBuilder&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;lt;&lt;/span&gt;AuthenticationManagerBuilder&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;gt; {&lt;/span&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-1600" y="-170" width="560" height="100" as="geometry" />
        </mxCell>
        <mxCell id="Jl6kpFa6PzPxEvhcqufj-31" value="&lt;pre style=&quot;background-color:#2b2b2b;color:#a9b7c6;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:10.5pt;&quot;&gt;&lt;span style=&quot;color:#bbb529;&quot;&gt;@Configuration&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;proxyBeanMethods = &lt;span style=&quot;color:#cc7832;&quot;&gt;false&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;pre style=&quot;background-color:#2b2b2b;color:#a9b7c6;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:10.5pt;&quot;&gt;&lt;span style=&quot;font-size: 10.5pt; color: rgb(204, 120, 50);&quot;&gt;class &lt;/span&gt;&lt;span style=&quot;font-size: 10.5pt;&quot;&gt;HttpSecurityConfiguration &lt;/span&gt;&lt;span style=&quot;font-size: 10.5pt; color: rgb(232, 186, 54);&quot;&gt;{&lt;/span&gt;&lt;/pre&gt;&lt;pre style=&quot;background-color:#2b2b2b;color:#a9b7c6;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:10.5pt;&quot;&gt;// HttpSecurity 是原型模式 当每次需要到的时候 都是一个新的 http安全对象&lt;/pre&gt;&lt;pre style=&quot;background-color:#2b2b2b;color:#a9b7c6;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:10.5pt;&quot;&gt;&lt;span style=&quot;color:#bbb529;&quot;&gt;@Bean&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#9876aa;font-style:italic;&quot;&gt;HTTPSECURITY_BEAN_NAME&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#bbb529;&quot;&gt;@Scope&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6a8759;&quot;&gt;&quot;prototype&quot;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;HttpSecurity &lt;span style=&quot;color:#ffc66d;&quot;&gt;httpSecurity&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;() &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;throws &lt;/span&gt;Exception &lt;span style=&quot;color:#54a857;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;   &lt;/span&gt;WebSecurityConfigurerAdapter.LazyPasswordEncoder passwordEncoder = &lt;span style=&quot;color:#cc7832;&quot;&gt;new &lt;/span&gt;WebSecurityConfigurerAdapter.LazyPasswordEncoder&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;         &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;context&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;AuthenticationManagerBuilder authenticationBuilder = &lt;span style=&quot;color:#cc7832;&quot;&gt;new &lt;/span&gt;WebSecurityConfigurerAdapter.DefaultPasswordEncoderAuthenticationManagerBuilder&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;         &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;objectPostProcessor&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;, &lt;/span&gt;passwordEncoder&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;; &lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;authenticationBuilder.parentAuthenticationManager&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;authenticationManager&lt;span style=&quot;color:#54a857;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;; // 创建&lt;/span&gt;AuthenticationManagerBuilder&lt;span style=&quot;color:#cc7832;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;HttpSecurity http = &lt;span style=&quot;color:#cc7832;&quot;&gt;new &lt;/span&gt;HttpSecurity&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;this&lt;/span&gt;.&lt;span style=&quot;color:#9876aa;&quot;&gt;objectPostProcessor&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;, &lt;/span&gt;authenticationBuilder&lt;span style=&quot;color:#cc7832;&quot;&gt;, &lt;/span&gt;createSharedObjects&lt;span style=&quot;color:#54a857;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color:#808080;&quot;&gt;// @formatter:off  默认10个配置 配置会产生 Filter 再放入 SecurityFilterChain&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#808080;&quot;&gt;   &lt;/span&gt;http&lt;br&gt;      .csrf&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-style:italic;&quot;&gt;withDefaults&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;      &lt;/span&gt;.addFilter&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;new &lt;/span&gt;WebAsyncManagerIntegrationFilter&lt;span style=&quot;color:#54a857;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;      &lt;/span&gt;.exceptionHandling&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-style:italic;&quot;&gt;withDefaults&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;      &lt;/span&gt;.headers&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-style:italic;&quot;&gt;withDefaults&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;      &lt;/span&gt;.sessionManagement&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-style:italic;&quot;&gt;withDefaults&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;      &lt;/span&gt;.securityContext&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-style:italic;&quot;&gt;withDefaults&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;      &lt;/span&gt;.requestCache&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-style:italic;&quot;&gt;withDefaults&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;      &lt;/span&gt;.anonymous&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-style:italic;&quot;&gt;withDefaults&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;      &lt;/span&gt;.servletApi&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-style:italic;&quot;&gt;withDefaults&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;      &lt;/span&gt;.apply&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;new &lt;/span&gt;DefaultLoginPageConfigurer&lt;span style=&quot;color:#e8ba36;&quot;&gt;&amp;lt;&amp;gt;&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;http.logout&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-style:italic;&quot;&gt;withDefaults&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   &lt;/span&gt;&lt;span style=&quot;color:#808080;&quot;&gt;// @formatter:on&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#808080;&quot;&gt;   &lt;/span&gt;applyDefaultConfigurers&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;http&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;   return &lt;/span&gt;http&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-1630" y="550" width="1300" height="370" as="geometry" />
        </mxCell>
        <mxCell id="Jl6kpFa6PzPxEvhcqufj-34" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.25;exitDx=0;exitDy=0;entryX=0.25;entryY=1;entryDx=0;entryDy=0;" parent="1" source="Jl6kpFa6PzPxEvhcqufj-32" target="Jl6kpFa6PzPxEvhcqufj-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Jl6kpFa6PzPxEvhcqufj-32" value="&lt;pre style=&quot;background-color:#2b2b2b;color:#a9b7c6;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:10.5pt;&quot;&gt;&lt;span style=&quot;color:#bbb529;&quot;&gt;@Bean&lt;br&gt;&lt;/span&gt;WebSecurityCustomizer &lt;span style=&quot;color:#ffc66d;&quot;&gt;webSecurityCustomizer&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;() &lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;{&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;return &lt;/span&gt;web -&amp;gt; web.ignoring&lt;span style=&quot;color:#e8ba36;&quot;&gt;()&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;            &lt;/span&gt;.antMatchers&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6a8759;&quot;&gt;&quot;/component/**&quot;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;            &lt;/span&gt;.antMatchers&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6a8759;&quot;&gt;&quot;/actuator/health&quot;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;            &lt;/span&gt;.antMatchers&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6a8759;&quot;&gt;&quot;/h2-console/**&quot;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;            &lt;/span&gt;.antMatchers&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6a8759;&quot;&gt;&quot;/pear.config.json&quot;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;            &lt;/span&gt;.antMatchers&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6a8759;&quot;&gt;&quot;/pear.config.yml&quot;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;            &lt;/span&gt;.antMatchers&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6a8759;&quot;&gt;&quot;/admin/css/**&quot;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;            &lt;/span&gt;.antMatchers&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6a8759;&quot;&gt;&quot;/admin/fonts/**&quot;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;            &lt;/span&gt;.antMatchers&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6a8759;&quot;&gt;&quot;/admin/js/**&quot;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;            &lt;/span&gt;.antMatchers&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6a8759;&quot;&gt;&quot;/admin/images/**&quot;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;            &lt;/span&gt;.antMatchers&lt;span style=&quot;color:#e8ba36;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#6a8759;&quot;&gt;&quot;/favicon.ico&quot;&lt;/span&gt;&lt;span style=&quot;color:#e8ba36;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color:#cc7832;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;color:#54a857;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2830" y="1620" width="430" height="290" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
